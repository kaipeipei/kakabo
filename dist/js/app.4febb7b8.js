(function(e){function t(t){for(var a,n,c=t[0],i=t[1],r=t[2],u=0,p=[];u<c.length;u++)n=c[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&p.push(s[n][0]),s[n]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);d&&d(t);while(p.length)p.shift()();return o.push.apply(o,r||[]),l()}function l(){for(var e,t=0;t<o.length;t++){for(var l=o[t],a=!0,c=1;c<l.length;c++){var i=l[c];0!==s[i]&&(a=!1)}a&&(o.splice(t--,1),e=n(n.s=l[0]))}return e}var a={},s={app:0},o=[];function n(t){if(a[t])return a[t].exports;var l=a[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=a,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(l,a,function(t){return e[t]}.bind(null,a));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var r=0;r<c.length;r++)t(c[r]);var d=i;o.push([0,"chunk-vendors"]),l()})({0:function(e,t,l){e.exports=l("56d7")},"2aa4":function(e,t,l){},"391c":function(e,t,l){"use strict";l("5a81")},"3b93":function(e){e.exports=JSON.parse('{"templates":[{"id":"852","name":"GM后台邮件","title":"GM后台标题{{msgReasonMail}}","content":"邮件{{msgReasonMail}}游戏{{msgReasonMail}}标题{{msgReasonMail}}发起人{{msgReasonMail}}点击这里查看{{msgReasonMail}}","titleVariable":"{{msgReasonMail}}","contentVariable":"{{msgReasonMail}}{{msgReasonMail}}{{msgReasonMail}}{{msgReasonMail}}{{msgReasonMail}}{{msgReasonMail}}","picUrl":"https://img2.woyaogexing.com/2022/07/05/24c10402c0b964ba!400x400.jpg"}],"groups":[{"id":"121","name":"未分组"}],"messages":[{"id":"964","name":"GM后台消息-邮件","group":0,"tool":"钉钉","type":"机器人单聊","templateId":0,"state":"using"}]}')},"41a0":function(e,t,l){},"56d7":function(e,t,l){"use strict";l.r(t);var a=l("7a23");function s(e,t){const l=Object(a["M"])("router-view");return Object(a["D"])(),Object(a["k"])("div",null,[Object(a["n"])(l)])}l("391c");var o=l("6b0d"),n=l.n(o);const c={},i=n()(c,[["render",s]]);var r=i,d=l("6605");const u={class:"outter"},p={key:0},b={key:1},m={key:2};function h(e,t,l,s,o,n){const c=Object(a["M"])("aside-menu"),i=Object(a["M"])("n-tag"),r=Object(a["M"])("n-config-provider"),d=Object(a["M"])("template-manager"),h=Object(a["M"])("message-manager"),O=Object(a["M"])("edit-template");return Object(a["D"])(),Object(a["k"])("div",u,[Object(a["l"])("aside",null,[Object(a["n"])(c,{onChangeMenu:e.onMenuChange},null,8,["onChangeMenu"])]),Object(a["l"])("main",null,[Object(a["l"])("header",null,[Object(a["n"])(r,null,{default:Object(a["U"])(()=>[(Object(a["D"])(!0),Object(a["k"])(a["b"],null,Object(a["K"])(e.pages,(t,l)=>(Object(a["D"])(),Object(a["i"])(i,{class:Object(a["w"])(t.active?"active":""),round:"",closable:0!=l,onClick:t=>e.choosePage(l),onClose:Object(a["W"])(t=>e.handleClose(l),["stop"])},{default:Object(a["U"])(()=>[Object(a["m"])(Object(a["O"])(t.name),1)]),_:2},1032,["class","closable","onClick","onClose"]))),256))]),_:1})]),(Object(a["D"])(!0),Object(a["k"])(a["b"],null,Object(a["K"])(e.pages,(t,l)=>(Object(a["D"])(),Object(a["k"])("section",null,[Object(a["V"])(Object(a["l"])("div",null,["1"==t.type?(Object(a["D"])(),Object(a["k"])("div",p,[Object(a["n"])(d,{onAddTemplate:e.buildAddTemplatePage,onAlterTemplate:e.buildAlterTemplatePage},null,8,["onAddTemplate","onAlterTemplate"])])):"2"==t.type?(Object(a["D"])(),Object(a["k"])("div",b,[Object(a["n"])(h)])):"3"==t.type?(Object(a["D"])(),Object(a["k"])("div",m,[Object(a["n"])(O,{onEditFinish:e.editFinish,index:l,templateData:t.templateData},null,8,["onEditFinish","index","templateData"])])):Object(a["j"])("",!0)],512),[[a["R"],t.active]])]))),256))])])}const O=e=>(Object(a["G"])("data-v-7a209866"),e=e(),Object(a["E"])(),e),g={class:"menuWrap"},j={class:"menuContent"},f=["onClick"],v=["innerHTML"],w={style:{width:"20px",height:"20px"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},M=O(()=>Object(a["l"])("path",{d:"M11.67 3.87L9.9 2.1L0 12l9.9 9.9l1.77-1.77L3.54 12z",fill:"currentColor"},null,-1)),x=[M],k=["onClick"],y=O(()=>Object(a["l"])("span",null,null,-1));function U(e,t,l,s,o,n){return Object(a["D"])(),Object(a["k"])("div",g,[(Object(a["D"])(!0),Object(a["k"])(a["b"],null,Object(a["K"])(o.menu,(e,t)=>(Object(a["D"])(),Object(a["k"])("div",j,[Object(a["l"])("div",{class:Object(a["w"])(["menuTitle",e.state?"titleActive":""]),onClick:e=>n.clickTitle(t)},[Object(a["l"])("span",{innerHTML:e.icon},null,8,v),Object(a["l"])("span",null,Object(a["O"])(e.title),1),Object(a["l"])("span",null,[(Object(a["D"])(),Object(a["k"])("svg",w,x))])],10,f),1==e.state?(Object(a["D"])(!0),Object(a["k"])(a["b"],{key:0},Object(a["K"])(e.children,(e,l)=>(Object(a["D"])(),Object(a["k"])("div",{onClick:e=>n.clickItem(t,l),class:Object(a["w"])(["menuItem",e.active?"itemActive":""])},[y,Object(a["l"])("span",null,Object(a["O"])(e.name),1)],10,k))),256)):Object(a["j"])("",!0)]))),256))])}var C={data(){return{name:"lin",menu:[{title:"自动化测试管理",icon:'<svg style="width:25px;height:25px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20"><g fill="none"><path d="M6 2.5a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 6h.21L5.25 9.08a2.5 2.5 0 0 0 .103 2.335l3.463 5.907a1.373 1.373 0 0 0 2.368 0l3.463-5.907a2.5 2.5 0 0 0 .102-2.335L13.29 6h.21A1.5 1.5 0 0 0 15 4.5v-2a.5.5 0 0 0-1 0v2a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-2zM12.184 6l1.662 3.509a1.5 1.5 0 0 1-.062 1.4L10.5 16.511v-5.645a1 1 0 1 0-1 0v5.645L6.216 10.91a1.5 1.5 0 0 1-.062-1.4L7.816 6h4.368z" fill="currentColor"></path></g></svg>',state:0,children:[]},{title:"消息中转",icon:'<svg style="width:25px;height:25px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1024 1024"><path d="M924.3 338.4a447.57 447.57 0 0 0-96.1-143.3a443.09 443.09 0 0 0-143-96.3A443.91 443.91 0 0 0 512 64h-2c-60.5.3-119 12.3-174.1 35.9a444.08 444.08 0 0 0-141.7 96.5a445 445 0 0 0-95 142.8A449.89 449.89 0 0 0 65 514.1c.3 69.4 16.9 138.3 47.9 199.9v152c0 25.4 20.6 46 45.9 46h151.8a447.72 447.72 0 0 0 199.5 48h2.1c59.8 0 117.7-11.6 172.3-34.3A443.2 443.2 0 0 0 827 830.5c41.2-40.9 73.6-88.7 96.3-142c23.5-55.2 35.5-113.9 35.8-174.5c.2-60.9-11.6-120-34.8-175.6zM312.4 560c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48s47.9 21.5 47.9 48s-21.4 48-47.9 48zm199.6 0c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48s47.9 21.5 47.9 48s-21.5 48-47.9 48zm199.6 0c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48s47.9 21.5 47.9 48s-21.5 48-47.9 48z" fill="currentColor"></path></svg>',state:1,children:[{name:"模板管理",active:!0},{name:"消息管理",active:!1}]}]}},methods:{clickTitle(e){this.menu.forEach((t,l)=>{l==e?1==t.state?t.state=0:t.state=1:t.state=0})},clickItem(e,t){this.menu.forEach((l,a)=>{l.children.forEach((l,s)=>{a==e&&s==t?(0==l.active&&(l.active=!0),this.$emit("changeMenu",{itemName:l.name})):l.active=!1})})}}};l("802c");const _=n()(C,[["render",U],["__scopeId","data-v-7a209866"]]);var D=_;const I=e=>(Object(a["G"])("data-v-51929252"),e=e(),Object(a["E"])(),e),V={class:"templateWrap"},N={class:"header"},S=Object(a["m"])("新建"),z={class:"content"},T=I(()=>Object(a["l"])("thead",null,[Object(a["l"])("tr",null,[Object(a["l"])("th",null,"模板ID"),Object(a["l"])("th",null,"模板名称"),Object(a["l"])("th",null,"消息标题"),Object(a["l"])("th",null,"消息正文"),Object(a["l"])("th",null,"标题变量"),Object(a["l"])("th",null,"正文变量"),Object(a["l"])("th",null,"效果图示"),Object(a["l"])("th",null,"操作")])],-1)),G={class:"imgWrap"},P={style:{color:"blue"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},A=I(()=>Object(a["l"])("path",{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3l150.1 178L658.1 489L888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 1 0 0-176a88 88 0 0 0 0 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28s-28-12.5-28-28s12.5-28 28-28z",fill:"currentColor"},null,-1)),H=[A],L=I(()=>Object(a["l"])("span",null,"修改图片",-1)),$=I(()=>Object(a["l"])("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},[Object(a["l"])("g",{fill:"none"},[Object(a["l"])("path",{d:"M27.314 10.344a4 4 0 0 0-5.657-5.657L20.254 6.09l5.656 5.657l1.404-1.403zm-2.818 2.818L12.541 25.117a4.999 4.999 0 0 1-2.323 1.315l-4.582 1.146a1 1 0 0 1-1.213-1.213l1.146-4.582a5 5 0 0 1 1.315-2.323L18.839 7.505l5.657 5.657z",fill:"currentColor"})])],-1)),B=I(()=>Object(a["l"])("span",null,"修改模板",-1)),R={style:{color:"red"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},E=I(()=>Object(a["l"])("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z",fill:"currentColor"},null,-1)),F=[E],J=I(()=>Object(a["l"])("span",null,"删除模板",-1)),q=Object(a["m"])("提交"),W={class:"confirmModal"},K=Object(a["m"])("确认"),Q=Object(a["m"])("取消");function X(e,t,l,s,o,n){const c=Object(a["M"])("n-button"),i=Object(a["M"])("n-image"),r=Object(a["M"])("n-popover"),d=Object(a["M"])("n-table"),u=Object(a["M"])("n-card"),p=Object(a["M"])("n-input"),b=Object(a["M"])("n-modal");return Object(a["D"])(),Object(a["k"])("div",null,[Object(a["n"])(u,null,{default:Object(a["U"])(()=>[Object(a["l"])("div",V,[Object(a["l"])("div",N,[Object(a["n"])(c,{onClick:n.buildTemplate},{default:Object(a["U"])(()=>[S]),_:1},8,["onClick"])]),Object(a["l"])("div",z,[Object(a["n"])(d,{"single-line":!1},{default:Object(a["U"])(()=>[T,Object(a["l"])("tbody",null,[(Object(a["D"])(!0),Object(a["k"])(a["b"],null,Object(a["K"])(n.templates,(e,t)=>(Object(a["D"])(),Object(a["k"])("tr",null,[Object(a["l"])("td",null,Object(a["O"])(e.id),1),Object(a["l"])("td",null,Object(a["O"])(e.name),1),Object(a["l"])("td",null,Object(a["O"])(e.title),1),Object(a["l"])("td",null,Object(a["O"])(e.content),1),Object(a["l"])("td",null,Object(a["O"])(e.titleVariable),1),Object(a["l"])("td",null,Object(a["O"])(e.contentVariable),1),Object(a["l"])("td",G,[Object(a["n"])(i,{width:"150",src:e.picUrl},null,8,["src"])]),Object(a["l"])("td",null,[Object(a["n"])(r,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:e=>n.alterPicture(t)},{default:Object(a["U"])(()=>[(Object(a["D"])(),Object(a["k"])("svg",P,H))]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[L]),_:2},1024),Object(a["n"])(r,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:e=>n.alterTemplate(t)},{default:Object(a["U"])(()=>[$]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[B]),_:2},1024),Object(a["n"])(r,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:e=>n.showDeleteConfirmModal(t)},{default:Object(a["U"])(()=>[(Object(a["D"])(),Object(a["k"])("svg",R,F))]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[J]),_:2},1024)])]))),256))])]),_:1})])])]),_:1}),Object(a["n"])(b,{show:o.picAlterModal.showModal,"onUpdate:show":t[1]||(t[1]=e=>o.picAlterModal.showModal=e)},{default:Object(a["U"])(()=>[Object(a["n"])(u,{style:{width:"600px"},title:"输入你的图片的url",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{footer:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:n.submitNewPic},{default:Object(a["U"])(()=>[q]),_:1},8,["onClick"])]),default:Object(a["U"])(()=>[Object(a["n"])(p,{value:o.picAlterModal.pictureUrl,"onUpdate:value":t[0]||(t[0]=e=>o.picAlterModal.pictureUrl=e),type:"text",placeholder:"基本的 Input"},null,8,["value"])]),_:1})]),_:1},8,["show"]),Object(a["n"])(b,{show:o.deleteConfirmModal.showModal,"onUpdate:show":t[4]||(t[4]=e=>o.deleteConfirmModal.showModal=e)},{default:Object(a["U"])(()=>[Object(a["n"])(u,{style:{width:"600px"},title:"确认删除?",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:Object(a["U"])(()=>[Object(a["l"])("div",W,[Object(a["n"])(c,{onClick:t[2]||(t[2]=e=>n.handleDeleteTemplate("confirm")),type:"success"},{default:Object(a["U"])(()=>[K]),_:1}),Object(a["n"])(c,{onClick:t[3]||(t[3]=e=>n.handleDeleteTemplate("cancel")),type:"error"},{default:Object(a["U"])(()=>[Q]),_:1})])]),_:1})]),_:1},8,["show"]),Object(a["n"])(b,{show:o.messageModal.isShow,"onUpdate:show":t[5]||(t[5]=e=>o.messageModal.isShow=e)},{default:Object(a["U"])(()=>[Object(a["n"])(u,{style:{width:"600px"},bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:Object(a["U"])(()=>[Object(a["m"])(Object(a["O"])(o.messageModal.content),1)]),_:1})]),_:1},8,["show"])])}var Y=l("b6e9"),Z=l("4951"),ee=l("3519"),te=l("1442"),le=l("6e31"),ae=l("fedc"),se=l("9a21");const oe=l("bc3a");var ne=oe,ce={components:{NInput:Y["a"],NCard:Z["c"],NButton:ee["a"],NTable:te["a"],NModal:le["a"],NImage:ae["a"],NPopover:se["a"]},data(){return{messageModal:{isShow:!1,content:""},picAlterModal:{showModal:!1,pictureUrl:"",index:0},deleteConfirmModal:{showModal:!1,index:0}}},computed:{templates(){return console.log(this.$store.state.templates),this.$store.state.templates}},mounted(){this.getTemplates()},methods:{showMessageModal(e){this.messageModal={isShow:!0,content:e},setTimeout(()=>{this.messageModal.isShow=!1},1e3)},async getTemplates(){let{data:e}=await ne.get("/template/get");this.$store.commit("updateTemplate",e.data.templates)},buildTemplate(){this.$emit("addTemplate")},alterPicture(e){this.picAlterModal={showModal:!0,pictureUrl:"",index:e}},async submitNewPic(){console.log(this.templates),console.log(this.picAlterModal.index);let{data:e}=await ne.post("/template/alterPic",{id:this.templates[this.picAlterModal.index].id,value:this.picAlterModal.pictureUrl});(e.message="success")?(this.templates[this.picAlterModal.index].picUrl=this.picAlterModal.pictureUrl,this.showMessageModal("修改成功")):this.showMessageModal("修改失败"),this.picAlterModal={showModal:!1,pictureUrl:"",index:0}},alterTemplate(e){this.$emit("alterTemplate",this.templates[e])},showDeleteConfirmModal(e){this.deleteConfirmModal={showModal:!0,index:e}},async handleDeleteTemplate(e){if("confirm"==e){let{data:e}=await ne.delete("/template/delete",{params:{id:this.templates[this.deleteConfirmModal.index].id}});if("success"==e.message){this.showMessageModal("删除模板成功");let e=this.templates;e.splice(this.deleteConfirmModal.index,1),this.$store.commit("updateTemplate",e)}}this.deleteConfirmModal={showModal:!1,index:0}}}};l("9c0f");const ie=n()(ce,[["render",X],["__scopeId","data-v-51929252"]]);var re=ie;const de={class:"messageWrap"},ue={class:"group"},pe={class:"message"};function be(e,t,l,s,o,n){const c=Object(a["M"])("group"),i=Object(a["M"])("message");return Object(a["D"])(),Object(a["k"])("div",de,[Object(a["l"])("div",ue,[Object(a["n"])(c,{onCreateMessage:n.onCreateMessage,onAlterMessage:n.onAlterMessage},null,8,["onCreateMessage","onAlterMessage"])]),Object(a["l"])("div",pe,[Object(a["n"])(i,{pos:o.controller.pos,type:o.controller.type,formValue:o.controller.formValue,onMessageHandleFinish:n.onMessaegFinish},null,8,["pos","type","formValue","onMessageHandleFinish"])])])}const me=e=>(Object(a["G"])("data-v-f40c7008"),e=e(),Object(a["E"])(),e),he={class:"groupWrap"},Oe=Object(a["m"])("新建消息分组"),ge={class:"groupHeader"},je=Object(a["m"])(" 筛选消息 "),fe=Object(a["m"])("使用中"),ve=Object(a["m"])("已归档"),we={class:"groups"},Me={style:{margin:"0px 5px"}},xe={style:{width:"20px",height:"20px",color:"green"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},ke=me(()=>Object(a["l"])("path",{d:"M17 15V8h-2v7H8v2h7v7h2v-7h7v-2z",fill:"currentColor"},null,-1)),ye=[ke],Ue=me(()=>Object(a["l"])("span",null,"新建消息",-1)),Ce={style:{width:"20px",height:"20px",color:"blue"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},_e=me(()=>Object(a["l"])("g",{fill:"none"},[Object(a["l"])("path",{d:"M13.416 2.584c.778.778.778 2.039 0 2.817L6.058 12.76c-.319.32-.719.546-1.156.655l-2.283.57a.498.498 0 0 1-.604-.603l.57-2.283a2.49 2.49 0 0 1 .656-1.156l7.358-7.358a1.992 1.992 0 0 1 2.817 0zM9.894 4.697l-5.949 5.949a1.495 1.495 0 0 0-.393.694l-.369 1.477l1.477-.37c.263-.065.503-.2.694-.392l5.949-5.95l-1.409-1.408zm1.41-1.41l-.705.705l1.408 1.409l.705-.704a.996.996 0 0 0-1.409-1.41z",fill:"currentColor"})],-1)),De=[_e],Ie=me(()=>Object(a["l"])("span",null,"编辑分组名",-1)),Ve={style:{width:"20px",height:"20px",color:"red"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ne=me(()=>Object(a["l"])("g",{fill:"none"},[Object(a["l"])("path",{d:"M11.5 4a1.5 1.5 0 0 0-3 0h-1a2.5 2.5 0 0 1 5 0H17a.5.5 0 0 1 0 1h-.554L15.15 16.23A2 2 0 0 1 13.163 18H6.837a2 2 0 0 1-1.987-1.77L3.553 5H3a.5.5 0 0 1-.492-.41L2.5 4.5A.5.5 0 0 1 3 4h8.5zm3.938 1H4.561l1.282 11.115a1 1 0 0 0 .994.885h6.326a1 1 0 0 0 .993-.885L15.438 5zM8.5 7.5c.245 0 .45.155.492.359L9 7.938v6.125c0 .241-.224.437-.5.437c-.245 0-.45-.155-.492-.359L8 14.062V7.939c0-.242.224-.438.5-.438zm3 0c.245 0 .45.155.492.359l.008.079v6.125c0 .241-.224.437-.5.437c-.245 0-.45-.155-.492-.359L11 14.062V7.939c0-.242.224-.438.5-.438z",fill:"currentColor"})],-1)),Se=[Ne],ze=me(()=>Object(a["l"])("span",null,"删除分组",-1)),Te={key:0,class:"groupMessage"},Ge={key:0,class:"groupMessage"},Pe=["onClick"],Ae={class:"messageHandler"},He={style:{width:"20px",height:"25px",color:"#e8e289"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Le=me(()=>Object(a["l"])("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",fill:"currentColor"},null,-1)),$e=[Le],Be=me(()=>Object(a["l"])("span",null,"复制ID",-1)),Re={key:0,style:{width:"20px",height:"25px",color:"greenyellow"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 384 512"},Ee=me(()=>Object(a["l"])("path",{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z",fill:"currentColor"},null,-1)),Fe=[Ee],Je={key:1,style:{width:"20px",height:"25px",color:"red"},xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},qe=me(()=>Object(a["l"])("path",{d:"M27.4 14.7l-6.1-6.1C21 8.2 20.5 8 20 8h-8c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V16.1c0-.5-.2-1-.6-1.4zM20 10l5.9 6H20v-6zm-8 18V10h6v6c0 1.1.9 2 2 2h6v10H12z",fill:"currentColor"},null,-1)),We=me(()=>Object(a["l"])("path",{d:"M6 18H4V4c0-1.1.9-2 2-2h14v2H6v14z",fill:"currentColor"},null,-1)),Ke=[qe,We],Qe={type:"text",class:"copyInput",ref:"input"},Xe=Object(a["m"])("确认");function Ye(e,t,l,s,o,n){const c=Object(a["M"])("n-button"),i=Object(a["M"])("n-input"),r=Object(a["M"])("n-popconfirm"),d=Object(a["M"])("n-popover"),u=Object(a["M"])("n-collapse-item"),p=Object(a["M"])("n-collapse"),b=Object(a["M"])("n-card"),m=Object(a["M"])("n-modal");return Object(a["D"])(),Object(a["k"])("div",he,[Object(a["n"])(b,null,{default:Object(a["U"])(()=>[Object(a["n"])(r,{show:o.showPop,"show-icon":!1,"positive-text":"创建","negative-text":null,onPositiveClick:n.buildGroup,onNegativeClick:t[2]||(t[2]=e=>o.groupInBuild.name="")},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:t[0]||(t[0]=e=>o.showPop=!o.showPop),type:"primary"},{default:Object(a["U"])(()=>[Oe]),_:1})]),default:Object(a["U"])(()=>[Object(a["n"])(i,{value:o.groupInBuild.name,"onUpdate:value":t[1]||(t[1]=e=>o.groupInBuild.name=e),type:"text"},null,8,["value"])]),_:1},8,["show","onPositiveClick"]),Object(a["l"])("div",ge,[je,Object(a["n"])(c,{color:"using"==o.nowState?"#7510d4":"",onClick:t[3]||(t[3]=e=>o.nowState="using")},{default:Object(a["U"])(()=>[fe]),_:1},8,["color"]),Object(a["n"])(c,{color:"saved"==o.nowState?"#7510d4":"",onClick:t[4]||(t[4]=e=>o.nowState="saved")},{default:Object(a["U"])(()=>[ve]),_:1},8,["color"])]),Object(a["l"])("div",we,[Object(a["n"])(p,null,{default:Object(a["U"])(()=>[(Object(a["D"])(!0),Object(a["k"])(a["b"],null,Object(a["K"])(n.groups,(t,l)=>(Object(a["D"])(),Object(a["i"])(u,null,{header:Object(a["U"])(()=>[Object(a["l"])("span",Me,Object(a["O"])(t.name),1),Object(a["n"])(d,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:Object(a["W"])(e=>n.handleGroup("add",l),["stop"]),bordered:!1},{default:Object(a["U"])(()=>[(Object(a["D"])(),Object(a["k"])("svg",xe,ye))]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[Ue]),_:2},1024),Object(a["n"])(d,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:Object(a["W"])(e=>n.handleGroup("edit",l),["stop"]),bordered:!1},{default:Object(a["U"])(()=>[(Object(a["D"])(),Object(a["k"])("svg",Ce,De))]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[Ie]),_:2},1024),Object(a["n"])(d,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:Object(a["W"])(e=>n.handleGroup("delete",l),["stop"]),bordered:!1},{default:Object(a["U"])(()=>[(Object(a["D"])(),Object(a["k"])("svg",Ve,Se))]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[ze]),_:2},1024)]),default:Object(a["U"])(()=>[n.isEmpty(t.children)?(Object(a["D"])(),Object(a["k"])("div",Te,"空")):Object(a["j"])("",!0),(Object(a["D"])(!0),Object(a["k"])(a["b"],null,Object(a["K"])(t.children,(t,s)=>(Object(a["D"])(),Object(a["k"])(a["b"],null,[t.state==o.nowState?(Object(a["D"])(),Object(a["k"])("div",Ge,[Object(a["l"])("div",{class:"messageConfig",onClick:a=>e.$emit("alterMessage",t,l,s)},[Object(a["l"])("div",null,Object(a["O"])(t.name),1),Object(a["l"])("div",null,Object(a["O"])(t.id),1)],8,Pe),Object(a["l"])("div",Ae,[Object(a["n"])(d,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:e=>n.copyMessageId(t.id)},{default:Object(a["U"])(()=>[(Object(a["D"])(),Object(a["k"])("svg",He,$e))]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[Be]),_:2},1024),Object(a["n"])(d,{trigger:"hover"},{trigger:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:e=>n.changeMessageState(l,s)},{default:Object(a["U"])(()=>["saved"==t.state?(Object(a["D"])(),Object(a["k"])("svg",Re,Fe)):Object(a["j"])("",!0),"using"==t.state?(Object(a["D"])(),Object(a["k"])("svg",Je,Ke)):Object(a["j"])("",!0)]),_:2},1032,["onClick"])]),default:Object(a["U"])(()=>[Object(a["l"])("span",null,Object(a["O"])("saved"==t.state?"使用":"归档"),1)]),_:2},1024)])])):Object(a["j"])("",!0)],64))),256))]),_:2},1024))),256))]),_:1})])]),_:1}),Object(a["l"])("input",Qe,null,512),Object(a["n"])(m,{show:o.editGroup.showModal,"onUpdate:show":t[6]||(t[6]=e=>o.editGroup.showModal=e)},{default:Object(a["U"])(()=>[Object(a["n"])(b,{style:{width:"600px"},title:"编辑新组名",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{footer:Object(a["U"])(()=>[Object(a["n"])(c,{onClick:n.confirmGroupName},{default:Object(a["U"])(()=>[Xe]),_:1},8,["onClick"])]),default:Object(a["U"])(()=>[Object(a["n"])(i,{value:o.editGroup.name,"onUpdate:value":t[5]||(t[5]=e=>o.editGroup.name=e),type:"text"},null,8,["value"])]),_:1})]),_:1},8,["show"]),Object(a["n"])(m,{show:o.messageModal.isShow,"onUpdate:show":t[7]||(t[7]=e=>o.messageModal.isShow=e)},{default:Object(a["U"])(()=>[Object(a["n"])(b,{style:{width:"600px"},bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:Object(a["U"])(()=>[Object(a["m"])(Object(a["O"])(o.messageModal.content),1)]),_:1})]),_:1},8,["show"])])}var Ze=l("7145"),et=l("400a"),tt=l("9c97"),lt={components:{NCard:Z["c"],NButton:ee["a"],NCollapse:Ze["b"],NCollapseItem:et["a"],NInput:Y["a"],NPopconfirm:tt["a"],NPopover:se["a"],NModal:le["a"]},data(){return{messageModal:{isShow:!1,content:""},editGroup:{name:"",showModal:!1,index:0,id:0},nowState:"using",showPop:!1,groupInBuild:{id:"-1",name:"",children:[]}}},computed:{groups(){return this.$store.state.groups}},mounted(){this.getGroups()},methods:{showMessageModal(e){this.messageModal={isShow:!0,content:e},setTimeout(()=>{this.messageModal.isShow=!1},1e3)},isEmpty(e){let t=e.some(e=>e.state==this.nowState);return!t},handleGroup(e,t){switch(e){case"delete":this.deleteGroup(t);break;case"add":this.$emit("createMessage",this.groups[t].id);break;case"edit":this.editGroup={name:this.groups[t].name,id:this.groups[t].id,showModal:!0,index:t};break}},async confirmGroupName(){let{data:e}=await ne.post("/group/alter",{id:this.editGroup.id,name:this.editGroup.name});if("success"==e.message){this.showMessageModal("修改成功");let e=this.groups;e[this.editGroup.index].name=this.editGroup.name,this.$store.commit("updateGroups",e),this.editGroup={name:"",showModal:!1,index:0}}},async deleteGroup(e){let t=this.groups[e].id,{data:l}=await ne.delete("/group/delete",{params:{id:t}});if(l.message){this.showMessageModal("删除成功");let e=this.groups.filter(e=>e.id!=t);this.$store.commit("updateGroups",e)}},copyMessageId(e){this.$refs.input.value=e,this.$refs.input.select(),document.execCommand("copy"),this.showMessageModal("复制成功")},async changeMessageState(e,t){let{data:l}=await ne.get("/message/alterState",{params:{id:this.groups[e].children[t].id}});if("success"==l.message){let l=this.groups;l[e].children[t].state="saved",this.showMessageModal(""+("using"==l[e].children[t].state?"转入使用":"归档成功")),this.$store.commit("updateGroups",l)}},async getGroups(){let{data:e}=await ne.get("/group/get");console.log(e.data),this.$store.commit("updateGroups",e.data.groups)},async buildGroup(){let{data:e}=await ne.post("/group/build",{name:this.groupInBuild.name});if(e.message="success"){this.showMessageModal("创建成功");let t=this.groups;e.data.children=[],t.push(e.data),this.$store.commit("updateGroups",t)}this.showPop=!1,this.groupInBuild={id:"-1",name:"",children:[]}}}};l("fd5d");const at=n()(lt,[["render",Ye],["__scopeId","data-v-f40c7008"]]);var st=at;const ot=e=>(Object(a["G"])("data-v-4f3ac48c"),e=e(),Object(a["E"])(),e),nt={key:0,class:"templatePreviw"},ct=ot(()=>Object(a["l"])("div",null,"模板预览",-1)),it=ot(()=>Object(a["l"])("span",null,"模板标题",-1)),rt=ot(()=>Object(a["l"])("span",null,"模板正文",-1)),dt=ot(()=>Object(a["l"])("span",null,"效果图示",-1));function ut(e,t,l,s,o,n){const c=Object(a["M"])("n-input"),i=Object(a["M"])("n-form-item"),r=Object(a["M"])("n-select"),d=Object(a["M"])("n-form"),u=Object(a["M"])("n-button"),p=Object(a["M"])("n-image"),b=Object(a["M"])("n-card"),m=Object(a["M"])("n-modal");return Object(a["D"])(),Object(a["k"])("div",null,[Object(a["n"])(b,null,{default:Object(a["U"])(()=>[Object(a["n"])(d,{"label-width":80,model:e.formValue,rules:e.rules},{default:Object(a["U"])(()=>[Object(a["n"])(i,{label:"消息名称",path:"name"},{default:Object(a["U"])(()=>[Object(a["n"])(c,{autosize:"",value:e.formValue.name,"onUpdate:value":t[0]||(t[0]=t=>e.formValue.name=t),placeholder:"请输入"},null,8,["value"])]),_:1}),Object(a["n"])(i,{label:"所属信息分组",path:"group"},{default:Object(a["U"])(()=>[Object(a["n"])(r,{autosize:"",value:e.formValue.group,"onUpdate:value":t[1]||(t[1]=t=>e.formValue.group=t),filterable:"",placeholder:"请选择",options:e.groupOption},null,8,["value","options"])]),_:1}),Object(a["n"])(i,{label:"消息工具",path:"tool"},{default:Object(a["U"])(()=>[Object(a["n"])(r,{disabled:"alter"==e.type,autosize:"",value:e.formValue.tool,"onUpdate:value":t[2]||(t[2]=t=>e.formValue.tool=t),filterable:"",placeholder:"请选择",options:e.toolOptions},null,8,["disabled","value","options"])]),_:1}),Object(a["n"])(i,{label:"信息类型",path:"type"},{default:Object(a["U"])(()=>[Object(a["n"])(r,{disabled:"alter"==e.type,autosize:"",value:e.formValue.type,"onUpdate:value":t[3]||(t[3]=t=>e.formValue.type=t),filterable:"",placeholder:"请选择",options:e.typeOptions},null,8,["disabled","value","options"])]),_:1}),Object(a["n"])(i,{label:"选择模板",path:"templateId"},{default:Object(a["U"])(()=>[Object(a["n"])(r,{autosize:"",value:e.formValue.templateId,"onUpdate:value":t[4]||(t[4]=t=>e.formValue.templateId=t),filterable:"",placeholder:"请选择",options:e.templateOptions},null,8,["value","options"])]),_:1})]),_:1},8,["model","rules"]),Object(a["l"])("div",null,[Object(a["n"])(u,{loading:e.loading,onClick:e.handleMessage,strong:"",secondary:"",round:"",type:"info"},{default:Object(a["U"])(()=>[Object(a["m"])(Object(a["O"])("create"==e.type?"创建":"更新"),1)]),_:1},8,["loading","onClick"])]),null!=e.formValue.templateId?(Object(a["D"])(),Object(a["k"])("div",nt,[ct,Object(a["l"])("div",null,[Object(a["l"])("div",null,[it,Object(a["l"])("div",null,Object(a["O"])(e.templatePreviewData.title),1)]),Object(a["l"])("div",null,[rt,Object(a["l"])("div",null,Object(a["O"])(e.templatePreviewData.content),1)])]),Object(a["l"])("div",null,[dt,Object(a["n"])(p,{width:"200",src:e.templatePreviewData.picUrl},null,8,["src"])])])):Object(a["j"])("",!0)]),_:1}),Object(a["n"])(m,{show:e.messageModal.isShow,"onUpdate:show":t[5]||(t[5]=t=>e.messageModal.isShow=t)},{default:Object(a["U"])(()=>[Object(a["n"])(b,{style:{width:"600px"},bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:Object(a["U"])(()=>[Object(a["m"])(Object(a["O"])(e.messageModal.content),1)]),_:1})]),_:1},8,["show"])])}var pt=l("7a5b"),bt=l("fe5b"),mt=l("7baf"),ht=l("bc3a"),Ot=l.n(ht),gt=Object(a["o"])({components:{NForm:pt["a"],NFormItem:bt["a"],NButton:ee["a"],NInput:Y["a"],NSelect:mt["a"],NCard:Z["c"],NImage:ae["a"],NModal:le["a"]},computed:{groups(){return this.$store.state.groups},templates(){return this.$store.state.templates},templateOptions(){let e=this.templates.map(e=>({label:e.name,value:e.id}));return console.log(e),e},groupOption(){let e=this.groups.map(e=>({label:e.name,value:e.id}));return e},templatePreviewData(){let e=this.templates.findIndex(e=>e.id==this.formValue.templateId);return this.templates[e]}},props:{pos:Object,type:{type:String,default:"create"},formValue:{type:Object,default:{id:-1,name:"",group:null,tool:null,type:null,templateId:null,state:"using"}}},data(){return{messageModal:{isShow:!1,content:""},loading:!1,typeOptions:[{label:"机器人单聊",value:"机器人单聊"},{label:"机器人群聊",value:"机器人群聊"}],toolOptions:[{label:"钉钉",value:"钉钉"},{label:"企业微信",value:"企业微信"}],rules:{name:{required:!0,message:"必填",trigger:"blur"},group:{required:!0,message:"必填",trigger:"blur"},tool:{required:!0,message:"必填",trigger:"blur"},type:{required:!0,message:"必填",trigger:"blur"},templateId:{required:!0,message:"必填",trigger:"blur"}}}},methods:{showMessageModal(e){this.messageModal={isShow:!0,content:e},setTimeout(()=>{this.messageModal.isShow=!1},1e3)},async handleMessage(){for(let e in this.formValue)if(""==this.formValue[e]||null==this.formValue[e])return void this.showMessageModal("有必填项未填");if(this.loading=!0,"create"==this.type){let{data:e}=await Ot.a.post("/message/build",this.formValue);if(this.loading=!1,"success"==e.message){this.showMessageModal("创建成功");let t=e.data,l=this.groups;for(let e=0;e<l.length;e++)if(l[e].id==t.group){l[e].children.push(t);break}this.$store.commit("updateGroups",l)}}else{let{data:e}=await Ot.a.post("/message/alterMessage",this.formValue);if(this.loading=!1,"success"==e.message){this.showMessageModal("更新成功");let e=this.groups,t=e.findIndex(e=>e.id==this.formValue.group),l=e[t].children.findIndex(e=>e.id==this.formValue.id);t==this.pos.groupIndex&&l==this.pos.childIndex?(e[t].children[l].name=this.formValue.name,e[t].children[l].group=this.formValue.group,e[t].children[l].templateId=this.formValue.templateId):(e[this.pos.groupIndex].children.splice(this.pos.childIndex,1),e[t].children.push(this.formValue)),this.$store.commit("updateGroups",e)}}this.$emit("messageHandleFinish")}}});l("d821");const jt=n()(gt,[["render",ut],["__scopeId","data-v-4f3ac48c"]]);var ft=jt,vt={components:{group:st,message:ft},data(){return{controller:{type:"create",formValue:{id:-1,name:"",group:null,tool:null,type:null,templateId:null,state:"using"}}}},methods:{onMessaegFinish(){this.controller={pos:{groupIndex:-1,childIndex:-1},type:"create",formValue:{id:-1,name:"",group:null,tool:null,type:null,templateId:null,state:"using"}}},onCreateMessage(e){this.controller={type:"create",formValue:{id:-1,name:"",group:e,tool:null,type:null,templateId:null,state:"using"}}},onAlterMessage(e,t,l){this.controller.type="alter",this.controller.formValue={...e},this.controller.pos={groupIndex:t,childIndex:l}}}};l("7b87");const wt=n()(vt,[["render",be],["__scopeId","data-v-3e2f674e"]]);var Mt=wt;const xt={key:0,class:"editPageTitle"},kt=Object(a["m"])(" 模板ID "),yt={class:"editWrap"},Ut={class:"subitBtn"},Ct=Object(a["m"])("提交");function _t(e,t,l,s,o,n){const c=Object(a["M"])("n-input"),i=Object(a["M"])("n-form-item"),r=Object(a["M"])("n-form"),d=Object(a["M"])("n-button"),u=Object(a["M"])("n-card"),p=Object(a["M"])("n-modal");return Object(a["D"])(),Object(a["k"])("div",null,[Object(a["n"])(u,null,{default:Object(a["U"])(()=>["-1"!=l.templateData.id?(Object(a["D"])(),Object(a["k"])("div",xt,[kt,Object(a["l"])("span",null,Object(a["O"])(l.templateData.id),1)])):Object(a["j"])("",!0),Object(a["l"])("div",yt,[Object(a["n"])(r,{"label-width":80,model:l.templateData,rules:o.rules},{default:Object(a["U"])(()=>[Object(a["n"])(i,{label:"模板名称",path:"name"},{default:Object(a["U"])(()=>[Object(a["n"])(c,{value:l.templateData.name,"onUpdate:value":t[0]||(t[0]=e=>l.templateData.name=e),placeholder:"请输入"},null,8,["value"])]),_:1}),Object(a["n"])(i,{label:"标题变量",path:"titleVariable"},{default:Object(a["U"])(()=>[Object(a["n"])(c,{value:l.templateData.titleVariable,"onUpdate:value":t[1]||(t[1]=e=>l.templateData.titleVariable=e),type:"textarea",autosize:{minRows:5}},null,8,["value"])]),_:1}),Object(a["n"])(i,{label:"消息标题",path:"title"},{default:Object(a["U"])(()=>[Object(a["n"])(c,{value:l.templateData.title,"onUpdate:value":t[2]||(t[2]=e=>l.templateData.title=e)},null,8,["value"])]),_:1}),Object(a["n"])(i,{label:"正文变量",path:"contentVariable"},{default:Object(a["U"])(()=>[Object(a["n"])(c,{value:l.templateData.contentVariable,"onUpdate:value":t[3]||(t[3]=e=>l.templateData.contentVariable=e),type:"textarea",autosize:{minRows:5}},null,8,["value"])]),_:1}),Object(a["n"])(i,{label:"消息正文",path:"content"},{default:Object(a["U"])(()=>[Object(a["n"])(c,{value:l.templateData.content,"onUpdate:value":t[4]||(t[4]=e=>l.templateData.content=e),type:"textarea",autosize:{minRows:5}},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),Object(a["l"])("div",Ut,[Object(a["n"])(d,{onClick:n.submitTemplate,round:"",type:"info"},{default:Object(a["U"])(()=>[Ct]),_:1},8,["onClick"])])]),_:1}),Object(a["n"])(p,{show:o.messageModal.isShow,"onUpdate:show":t[5]||(t[5]=e=>o.messageModal.isShow=e)},{default:Object(a["U"])(()=>[Object(a["n"])(u,{style:{width:"600px"},bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:Object(a["U"])(()=>[Object(a["m"])(Object(a["O"])(o.messageModal.content),1)]),_:1})]),_:1},8,["show"])])}var Dt={components:{NCard:Z["c"],NInput:Y["a"],NButton:ee["a"],NForm:pt["a"],NFormItem:bt["a"],NModal:le["a"]},props:{index:Number,templateData:{type:Object,default:{id:"-1",name:"",title:"",content:"",titleVariable:"",contentVariable:"",picUrl:""}}},data(){return{messageModal:{isShow:!1,content:""},rules:{name:{required:!0,message:"必填",trigger:"blur"},title:{required:!0,message:"必填",trigger:"blur"},content:{required:!0,message:"必填",trigger:"blur"},titleVariable:{required:!0,message:"必填",trigger:"blur"},contentVariable:{required:!0,message:"必填",trigger:"blur"}}}},methods:{showMessageModal(e){this.messageModal={isShow:!0,content:e},setTimeout(()=>{this.messageModal.isShow=!1},1e3)},valiateInput(){for(let e in this.templateData)if("picUrl"!=e&&0==this.templateData[e].length)return!1;return!0},async submitTemplate(){if(!this.valiateInput())return void this.showMessageModal("有必填项未填写");let{data:e}=await ne.post("/template/alterOrUpdate",this.templateData);"success"==e.message&&(this.showMessageModal("提交成功"),this.$emit("editFinish",this.index),this.$store.commit("alterOrUpdateTemplates",{type:"-1"==this.templateData.id?"add":"update",template:e.data}))}}};l("e527");const It=n()(Dt,[["render",_t],["__scopeId","data-v-67801464"]]);var Vt=It,Nt=l("5927"),St=l("6dc9"),zt=Object(a["o"])({components:{asideMenu:D,templateManager:re,messageManager:Mt,editTemplate:Vt,NConfigProvider:Nt["a"],NTag:St["a"],EditTemplate:Vt},data(){return{pages:[{name:"模板管理",type:1,active:!0}]}},mounted(){},methods:{onMenuChange(e){let t=!1;if(this.pages.forEach(l=>{l.name==e.itemName?(t=!0,l.active=!0):l.active=!1}),0==t){let t={name:e.itemName,type:"模板管理"==e.itemName?1:2,active:!0};this.pages.push(t)}},handleClose(e){let t=this.pages.splice(e,1);1==t[0].active&&(this.pages[0].active=!0)},choosePage(e){this.pages.forEach((t,l)=>{l==e?0==t.active&&(t.active=!0):t.active=!1})},buildAddTemplatePage(){let e=this.pages.findIndex(e=>{if(3==e.type&&"-1"==e.id)return!0});if(-1==e){let e={name:"编辑模板",type:3,templateData:{id:"-1",name:"",title:"",content:"",titleVariable:"",contentVariable:"",picUrl:""},id:"-1",active:!0};this.pages[0].active=!1,this.pages.push(e)}else this.pages[0].active=!1,this.pages[e].active=!0},buildAlterTemplatePage(e){let t=this.pages.findIndex(t=>{if(3==t.type&&t.id==e.id)return!0});if(-1==t){let t={name:`编辑模板(${e.name})`,type:3,templateData:e,active:!0,id:e.id};this.pages[0].active=!1,this.pages.push(t)}else this.pages[0].active=!1,this.pages[t].active=!0},editFinish(e){this.pages.splice(e,1),this.pages[0].active=!0}}});l("cbe4");const Tt=n()(zt,[["render",h],["__scopeId","data-v-31e6a9a7"]]);var Gt=Tt;const Pt=[{path:"/",component:Gt}],At=Object(d["a"])({history:Object(d["b"])(),routes:Pt});var Ht=At,Lt=l("5502"),$t=Object(Lt["a"])({state(){return{templates:[],groups:[],messages:[]}},mutations:{updateGroups(e,t){e.groups=t},updateTemplate(e,t){e.templates=t},alterOrUpdateTemplates(e,t){let l=t.template;"add"==t.type?e.templates.push(l):e.templates.forEach(e=>{if(e.id==l.id)for(let t in e)e[t]=l[t]})}},actions:{},modules:{}}),Bt=l("96eb"),Rt=l.n(Bt),Et=l("3b93");let Ft=localStorage.getItem("config");if(Ft)var Jt=JSON.parse(Ft);else Jt=Et;function qt(){localStorage.setItem("config",JSON.stringify(Jt))}Rt.a.mock("/template/get","get",()=>({message:"success",data:{templates:Jt.templates}})),Rt.a.mock("/template/build","post",e=>{let t=JSON.parse(e.body);return t.id=Rt.a.mock("@id"),Jt.templates.push(t),qt(),{message:"success",data:{template:t}}}),Rt.a.mock(/\/template\/alterPic.*/,"post",e=>{let{id:t,value:l}=JSON.parse(e.body),a=Jt.templates.findIndex(e=>{if(e.id==t)return!0});return Jt.templates[a].picUrl=l,qt(),{message:"success"}}),Rt.a.mock(/\/template\/alterOrUpdate.*/,"post",e=>{let t=JSON.parse(e.body);if("-1"==t.id)t.id=Rt.a.mock("@id"),Jt.templates.push(t);else{let e=Jt.templates.findIndex(e=>{if(e.id==t.id)return!0});Jt.templates[e]=t}return qt(),{message:"success",data:t}}),Rt.a.mock(/\/template\/delete.*/,"delete",e=>{console.log(e);let t=e.url.match(/id=(.+)/)[1],l=Jt.templates.filter(e=>e.id!=t);return Jt.templates=l,qt(),{message:"success"}}),Rt.a.mock("/group/get","get",e=>{let t=Jt.groups.map(e=>{let t=Jt.messages.filter(t=>t.group==e.id);return{...e,children:t}});return{message:"success",data:{groups:t}}}),Rt.a.mock("/group/build","post",e=>{let t=JSON.parse(e.body),l={id:Rt.a.mock("@id"),name:t.name};return Jt.groups.push(l),qt(),{message:"success",data:l}}),Rt.a.mock(/\/group\/delete.*/,"delete",e=>{let t=e.url.match(/id=(.*)/)[1];Jt.groups=Jt.groups.filter(e=>e.id!=t);let l=Jt.messages.filter(e=>e.group==t);return Jt.messages=l,qt(),{message:"success"}}),Rt.a.mock(/\/group\/alter.*/,"post",e=>{let t=JSON.parse(e.body),l=t.id,a=t.name;return Jt.groups.forEach(e=>{e.id==l&&(e.name=a)}),qt(),{message:"success"}}),Rt.a.mock(/\/message\/alterState.*/,"get",e=>{let t=e.url.match(/id=(.*)/)[1];return Jt.messages.map(e=>{e.id==t&&(e.state="using"==e.state?"saved":"using")}),qt(),{message:"success"}}),Rt.a.mock(/\/message\/build/,"post",e=>{let t=JSON.parse(e.body);return t.id=Rt.a.mock("@id"),Jt.messages.push(t),qt(),{message:"success",data:t}}),Rt.a.mock(/\/message\/alterMessage/,"post",e=>{let t=JSON.parse(e.body);return Jt.messages.map(e=>{e.id==t.id&&(e.name=t.name,e.group=t.group,e.templateId=t.templateId)}),qt(),{message:"success"}}),Object(a["h"])(r).use($t).use(Ht).mount("#app")},"5a81":function(e,t,l){},"7b87":function(e,t,l){"use strict";l("a0f0")},"802c":function(e,t,l){"use strict";l("e6fd")},9906:function(e,t,l){},"9c0f":function(e,t,l){"use strict";l("a0c9")},a0c9:function(e,t,l){},a0f0:function(e,t,l){},ab02:function(e,t,l){},cbe4:function(e,t,l){"use strict";l("41a0")},d821:function(e,t,l){"use strict";l("2aa4")},e527:function(e,t,l){"use strict";l("ab02")},e6fd:function(e,t,l){},fd5d:function(e,t,l){"use strict";l("9906")}});
//# sourceMappingURL=app.4febb7b8.js.map